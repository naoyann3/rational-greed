<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Rational Greed v5.0 - Strategic Asset Simulator</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Inter', 'Noto Sans JP', sans-serif; background-color: #f8fafc; color: #0f172a; -webkit-tap-highlight-color: transparent; }
  .card { background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); padding: 20px; border: 1px solid #e2e8f0; }
  .ranking-scroll::-webkit-scrollbar { width: 4px; }
  .ranking-scroll::-webkit-scrollbar-track { background: transparent; }
  .ranking-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
  .asset-checkbox:checked + div { background-color: #f1f5f9; border-color: currentColor; box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06); }
  .period-btn { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); touch-action: manipulation; }
  .period-btn.active { background-color: #0f172a; color: white; border-color: #0f172a; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(15, 23, 42, 0.3); }
  .ranking-item { transition: transform 0.2s ease, background-color 0.2s; cursor: pointer; border-left: 4px solid transparent; }
  .ranking-item:hover { transform: translateX(4px); background-color: #f8fafc; }
  .ranking-item.active-highlight { background-color: #f1f5f9; border-left-color: currentColor; }
  .simulation-result-card { transition: all 0.3s ease; border-left: 4px solid transparent; }
  .simulation-result-card:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(0, 0, 0, 0.05); }
</style>
</head>
<body class="p-3 md:p-8 max-w-[1600px] mx-auto bg-slate-50 pb-20">

  <!-- â˜…æˆ¦ç•¥ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªè¡¨ç¤ºã‚¨ãƒªã‚¢ (Rational Greed v5.0) -->
  <div class="card mb-6 p-4 bg-indigo-50 border-l-4 border-indigo-600 text-slate-900 shadow-sm">
    <div class="flex justify-between items-start mb-4">
      <h3 class="text-sm font-bold flex items-center">
        <span class="mr-2 text-indigo-900">ğŸ“Š 2026 Target Portfolio</span>
        <span class="text-[10px] bg-indigo-200 px-2 py-0.5 rounded text-indigo-800 font-extrabold">Rational Greed v5.0</span>
      </h3>
      <div class="text-[10px] text-slate-500 bg-white px-2 py-1 rounded border border-slate-200">
        æˆ¦ç•¥: ç†æ€§ã®æª»ã§é‡æ€§ã‚’é£¼ã„æ…£ã‚‰ã™
      </div>
    </div>
    
    <div class="flex flex-col md:flex-row items-center gap-8">
      <div class="w-40 h-40 relative shrink-0">
        <canvas id="portfolioChart"></canvas>
      </div>
      
      <div class="flex-1 w-full grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2 text-sm">
        <div class="flex justify-between items-center border-b border-indigo-200/50 pb-1">
          <span class="text-slate-600 font-medium">Cash (å††/ãƒ‰ãƒ«)</span>
          <span class="font-bold text-emerald-600">35%</span>
        </div>
        <div class="flex justify-between items-center border-b border-indigo-200/50 pb-1">
          <span class="text-slate-600 font-medium">AI (Hard+Soft)</span>
          <span class="font-bold text-indigo-600">20%</span>
        </div>
        <div class="flex justify-between items-center border-b border-indigo-200/50 pb-1">
          <span class="text-slate-600 font-medium">Defense/Software</span>
          <span class="font-bold text-cyan-600">20%</span>
        </div>
        <div class="flex justify-between items-center border-b border-indigo-200/50 pb-1">
          <span class="text-slate-600 font-medium">Bitcoin (BTC)</span>
          <span class="font-bold text-orange-600">15%</span>
        </div>
        <div class="flex justify-between items-center border-b border-indigo-200/50 pb-1">
          <span class="text-slate-600 font-medium">Silver (éŠ€)</span>
          <span class="font-bold text-slate-500">10%</span>
        </div>
      </div>
    </div>
  </div>

  <header class="mb-6 md:mb-10 text-center md:text-left md:flex md:justify-between md:items-end border-b border-slate-200 pb-4 md:pb-6">
    <div>
      <h1 class="text-2xl md:text-4xl font-extrabold text-slate-900 tracking-tight mb-2">è³‡ç”£ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¨ç§»</h1>
      <p class="text-slate-500 font-medium text-xs md:text-sm">
        <span class="bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded text-[10px] md:text-xs font-bold">å††å»ºã¦æ›ç®—</span>
        <span>2021.01 - 2025.11 (ç‚ºæ›¿ãƒ»æ ªå¼åˆ†å‰²åæ˜ æ¸ˆã¿)</span>
      </p>
    </div>
    <div class="mt-2 md:mt-0 text-right hidden md:block text-xl font-bold text-slate-700 font-mono">2025.12.25</div>
  </header>

  <!-- æœŸé–“é¸æŠ -->
  <div class="mb-6 overflow-x-auto">
    <div class="flex gap-2 min-w-max">
      <button class="period-btn active px-4 py-2 rounded-full border border-slate-200 font-bold text-xs" data-period="all">å…¨æœŸé–“</button>
      <button class="period-btn px-4 py-2 rounded-full border border-slate-200 font-bold text-xs" data-period="2022">2022å¹´ã€œ</button>
      <button class="period-btn px-4 py-2 rounded-full border border-slate-200 font-bold text-xs" data-period="2024">2024å¹´ã€œ</button>
      <button class="period-btn px-4 py-2 rounded-full border border-slate-200 font-bold text-xs" data-period="2025">2025å¹´ã€œ</button>
    </div>
  </div>

  <div class="flex flex-col lg:grid lg:grid-cols-4 gap-6">
    <div class="lg:col-span-3 order-1 space-y-6">
      <div class="card h-[55vh] md:h-[650px] relative p-1 md:p-6 w-full">
        <canvas id="chart"></canvas>
      </div>
      
      <div class="grid grid-cols-3 gap-2 md:gap-4">
        <div class="card bg-gradient-to-br from-indigo-50 to-white py-4 px-6">
          <div class="text-[10px] text-indigo-400 font-bold uppercase mb-1">Top Asset</div>
          <div id="summary-best-name" class="text-sm md:text-xl font-black text-indigo-900 truncate">-</div>
          <div id="summary-best-val" class="text-xs font-bold text-indigo-600">-</div>
        </div>
        <div class="card bg-white py-4 px-6 text-center">
          <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Average</div>
          <div id="summary-avg" class="text-sm md:text-xl font-black text-slate-700">-</div>
        </div>
        <div class="card bg-white py-4 px-6 text-right">
          <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Bottom Asset</div>
          <div id="summary-worst-name" class="text-sm md:text-xl font-black text-slate-700 truncate">-</div>
          <div id="summary-worst-val" class="text-xs font-bold text-slate-500">-</div>
        </div>
      </div>

      <div class="card">
        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-6 flex items-center">
          <span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded mr-2">SIM</span>
          ç©ç«‹æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (å††å»ºã¦)
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
          <input type="number" id="monthly-amount" value="20000" class="w-full px-4 py-2 border rounded-lg font-medium">
          <select id="start-year" class="w-full px-4 py-2 border rounded-lg font-medium">
            <option value="2021">2021å¹´</option>
            <option value="2022">2022å¹´</option>
            <option value="2023">2023å¹´</option>
            <option value="2024">2024å¹´</option>
            <option value="2025" selected>2025å¹´</option>
          </select>
          <select id="start-month" class="w-full px-4 py-2 border rounded-lg font-medium">
            <option value="01" selected>1æœˆ</option><option value="02">2æœˆ</option><option value="03">3æœˆ</option><option value="04">4æœˆ</option>
            <option value="05">5æœˆ</option><option value="06">6æœˆ</option><option value="07">7æœˆ</option><option value="08">8æœˆ</option>
            <option value="09">9æœˆ</option><option value="10">10æœˆ</option><option value="11">11æœˆ</option><option value="12">12æœˆ</option>
          </select>
          <button id="simulate-btn" class="w-full bg-indigo-600 text-white font-bold py-2 rounded-lg">å®Ÿè¡Œ</button>
        </div>
        <div id="simulation-results" class="space-y-4"></div>
      </div>
    </div>

    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <div class="lg:col-span-1 space-y-6 order-2">
      <div class="card p-4">
        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">è¡¨ç¤ºéŠ˜æŸ„ã®é¸æŠ</h3>
        <div class="grid grid-cols-1 gap-2" id="asset-toggles"></div>
      </div>
      <div class="card h-[400px] flex flex-col">
        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">é¨°è½ç‡ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
        <div class="flex-1 overflow-y-auto ranking-scroll pr-1 space-y-1" id="ranking-list"></div>
      </div>
    </div>
  </div>

<script>
// =========================================================
//  ãƒ‡ãƒ¼ã‚¿å®šç¾© (2021/01 - 2025/11) : å††å»ºã¦æ›ç®—æ¸ˆã¿ (Real Data)
// =========================================================
const db = {
  // AIãƒãƒ¼ãƒ‰ (SMH)
  SMH: [11861,12834,13431,13232,13694,14382,14387,14887,14342,15574,17349,17766,15871,15509,16461,14904,13063,13919,15792,14131,13369,13984,15531,13304,15468,16317,17529,15533,18476,20353,22615,22822,21656,20719,23597,24660,27392,31931,34050,33465,37744,41941,37731,35564,35056,37026,36258,38020,37541,34918,31639,30420,38379,40303,43093,42137,48496,55869,55009],
  
  // AIã‚½ãƒ•ãƒˆ1 (CRWD)
  CRWD: [22590,23010,20132,22708,24416,27779,27813,30894,27512,32078,24711,23559,20821,22565,22114,24203,20444,21808,24103,25464,26362,23828,23075,13805,13818,18711,18285,16365,22790,23405,20673,23395,25002,26351,34847,36005,43105,48301,48332,45729,49233,61648,35413,40525,40046,45482,51808,53717,61341,58454,73369,60292,65476,73604,73204,62292,72868,83569,79505],
  
  // AIã‚½ãƒ•ãƒˆ2 (PLTR)
  PLTR: [3683,2546,2569,2509,2522,2914,2381,2896,2691,2946,2350,2095,1580,1370,1675,1349,1109,1239,1379,1071,1174,1299,1041,842,1015,1152,1125,1056,2056,2220,2793,2190,2390,2207,2948,2421,2371,3467,3482,3434,3405,4075,3867,4601,5312,6367,10041,11863,12711,12739,12239,11854,18982,19684,23629,23039,27106,30852,26303],
  
  // ä»®æƒ³é€šè²¨ (BTC)
  BTC: [3467557,4813675,6507676,6310030,4088027,3891489,4557750,5183873,4875342,6989294,6428337,5319007,4430489,4964484,5540012,4925250,4091192,2705066,3103425,2785170,2811424,3048933,2368041,2169712,3009478,3149604,3779598,3987163,3792091,4397975,4159102,3774683,4026381,5256500,5591733,5961862,6269113,9170140,10792036,9569960,10622342,10096447,9686116,8620933,9095437,10688597,14438361,14707594,14672003,12710027,12374921,13463700,15066900,15436001,17446478,15999985,16864269,16870246,14114830],

  // é˜²è¡› (ITA)
  ITA: [9324,10185,11463,11592,12123,12107,11841,11652,11668,11896,11164,11826,11657,12934,13519,13339,13056,13543,13831,14151,13171,15847,15530,14666,14962,15637,15685,15535,15190,16892,16577,16972,15829,16381,17624,17853,18075,19266,19966,20300,21349,21244,21860,21588,21367,22126,23296,22819,24128,23220,22906,22646,25531,27262,29338,29172,31095,33210,32026],

  // éŠ€ (SLV)
  SILVER: [2616,2627,2418,2615,2847,2677,2592,2434,2297,2515,2397,2475,2397,2615,2792,2729,2535,2495,2300,2528,2528,3044,2835,2887,2848,2620,3015,3135,3021,3025,3194,3271,3038,3128,3401,3071,3082,3123,3443,3760,4357,4275,4030,3851,4058,4567,4181,4134,4393,4247,4638,4212,4321,4742,4972,5380,6296,6773,7996],

  // é‡‘ (GLD)
  GOLD: [18069,17238,17042,18041,19605,18308,18622,18658,18383,18971,18835,19671,19374,20618,22047,22942,21870,22472,21857,22102,22340,22454,22867,22242,23409,23144,24976,25192,25487,25244,25670,26301,25610,27450,27754,26959,27772,28521,31134,33123,33792,34591,34591,33804,34707,38839,36776,38013,39843,39493,43110,43220,43730,44053,45209,47258,52821,56654,60567],

  // æŒ‡æ¨™ (SP500)
  SP500: [13641,14043,15142,15861,15975,16444,16777,17277,16951,18163,18432,19204,17837,17684,19683,18851,18669,18301,19236,19417,18548,20365,19380,18035,18524,19213,19167,19670,20875,22664,22984,23519,22940,22238,23926,24281,26026,27391,28559,28832,29510,31789,29851,29198,29562,32262,32695,34182,33955,31801,30280,28788,30919,32527,34608,34812,36175,38371,38984]
};

const meta = {
  SMH:    { label:'AI Semi (SMH)', color:'#4f46e5', type:'stock' },
  PLTR:   { label:'AI Data (PLTR)', color:'#a855f7', type:'stock' },
  CRWD:   { label:'AI Cyber (CRWD)', color:'#06b6d4', type:'stock' },
  BTC:    { label:'Bitcoin (BTC)', color:'#f97316', type:'crypto' },
  ITA:    { label:'Defense (ITA)', color:'#eab308', type:'stock' },
  GOLD:   { label:'Gold (GLD)', color:'#ca8a04', type:'commodity' },
  SILVER: { label:'Silver (éŠ€)', color:'#64748b', type:'commodity' },
  SP500:  { label:'S&P 500', color:'#cbd5e1', type:'index' }
};

const labels = [];
let startY = 2021, startM = 1;
for (let i = 0; i < 59; i++) {
  labels.push(`${startY}/${String(startM).padStart(2,'0')}`);
  startM++;
  if (startM > 12) { startM = 1; startY++; }
}

let myChart = null;
let currentPeriod = 'all';
let activeKeys = ['SMH', 'PLTR', 'CRWD', 'BTC', 'SILVER']; 
let selectedAssetKey = null;

// =========================================================
//  UI & Chart Logic
// =========================================================

function initPortfolioChart() {
    const ctxP = document.getElementById('portfolioChart').getContext('2d');
    new Chart(ctxP, {
      type: 'doughnut',
      data: {
        labels: ['Cash', 'AI (H+S)', 'Defense', 'BTC', 'Silver'],
        datasets: [{
          data: [35, 20, 20, 15, 10],
          backgroundColor: ['#10b981', '#4f46e5', '#06b6d4', '#f97316', '#64748b'],
          borderWidth: 0
        }]
      },
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, cutout: '75%' }
    });
}

function init() {
  initPortfolioChart();
  createAssetToggles();
  setupEventListeners();
  renderChart();
  updateDashboard();
  setupSimulationListeners();
}

function createAssetToggles() {
  const container = document.getElementById('asset-toggles');
  Object.keys(meta).forEach(key => {
    const m = meta[key];
    const isChecked = activeKeys.includes(key) ? 'checked' : '';
    const div = document.createElement('div');
    div.innerHTML = `<label class="cursor-pointer block"><input type="checkbox" class="asset-checkbox hidden" value="${key}" ${isChecked}><div class="flex items-center p-2 rounded-lg border border-transparent transition-all hover:bg-white" style="color:${m.color}"><span class="w-3 h-3 rounded-full mr-2" style="background-color:${m.color}"></span><span class="font-bold text-xs text-slate-700">${m.label}</span></div></label>`;
    container.appendChild(div);
  });
}

function setupEventListeners() {
  document.querySelectorAll('.period-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      currentPeriod = e.target.dataset.period;
      updateDashboard();
    });
  });
  document.getElementById('asset-toggles').addEventListener('change', () => {
    activeKeys = Array.from(document.querySelectorAll('.asset-checkbox:checked')).map(c => c.value);
    updateDashboard('none');
  });
}

function updateDashboard(mode = 'default') {
  const startIdx = (currentPeriod === 'all') ? 0 : labels.indexOf(`${currentPeriod}/01`);
  const slicedLabels = labels.slice(startIdx);
  const datasets = activeKeys.map(key => {
    const rawData = db[key].slice(startIdx);
    const baseValue = rawData[0];
    return {
      label: meta[key].label,
      data: rawData.map(v => baseValue ? ((v - baseValue) / baseValue) * 100 : 0),
      rawValues: rawData,
      borderColor: selectedAssetKey && selectedAssetKey !== key ? '#e2e8f0' : meta[key].color,
      backgroundColor: meta[key].color,
      borderWidth: selectedAssetKey === key ? 4 : 2,
      pointRadius: 0, tension: 0.1, assetKey: key
    };
  });
  myChart.data.labels = slicedLabels;
  myChart.data.datasets = datasets;
  myChart.update(mode);
  updateRanking(activeKeys, startIdx);
}

function updateRanking(keys, startIdx) {
  const list = document.getElementById('ranking-list');
  list.innerHTML = '';
  const performance = keys.map(key => {
    const data = db[key];
    const change = ((data[data.length-1] - data[startIdx]) / data[startIdx]) * 100;
    return { key, change, label: meta[key].label, color: meta[key].color, val: data[data.length-1] };
  }).sort((a, b) => b.change - a.change);

  performance.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = "ranking-item p-2 rounded flex justify-between items-center text-xs";
    div.innerHTML = `<div><span class="font-bold" style="color:${item.color}">${item.label}</span></div><div class="text-right font-black ${item.change>=0?'text-emerald-500':'text-rose-500'}">${item.change.toFixed(1)}%</div>`;
    list.appendChild(div);
  });
  
  if(performance.length > 0) {
    document.getElementById('summary-best-name').textContent = performance[0].label;
    document.getElementById('summary-best-val').textContent = performance[0].change.toFixed(1) + '%';
    document.getElementById('summary-worst-name').textContent = performance[performance.length-1].label;
    document.getElementById('summary-worst-val').textContent = performance[performance.length-1].change.toFixed(1) + '%';
    const avg = performance.reduce((s, p) => s + p.change, 0) / performance.length;
    document.getElementById('summary-avg').textContent = avg.toFixed(1) + '%';
  }
}

function setupSimulationListeners() {
  document.getElementById('simulate-btn').addEventListener('click', () => {
    const amount = parseInt(document.getElementById('monthly-amount').value);
    const date = document.getElementById('start-year').value + '/' + document.getElementById('start-month').value;
    const results = activeKeys.map(key => {
      const res = calculateMonthlyInvestment(key, amount, date);
      return res ? {...res, label: meta[key].label, color: meta[key].color} : null;
    }).filter(r => r).sort((a,b) => b.profitPercentage - a.profitPercentage);

    const container = document.getElementById('simulation-results');
    container.innerHTML = results.map(r => `
      <div class="p-3 border rounded-lg bg-white border-l-4" style="border-left-color:${r.color}">
        <div class="flex justify-between items-center">
          <span class="font-bold text-sm">${r.label}</span>
          <span class="text-xs font-black ${r.profit>=0?'text-emerald-600':'text-rose-600'}">${r.profitPercentage.toFixed(1)}%</span>
        </div>
        <div class="text-right font-black text-lg">Â¥${Math.floor(r.currentValue).toLocaleString()}</div>
      </div>
    `).join('');
  });
}

function renderChart() {
  const ctx = document.getElementById('chart').getContext('2d');
  myChart = new Chart(ctx, {
    type: 'line',
    data: { labels: [], datasets: [] },
    options: {
      responsive: true, maintainAspectRatio: false,
      interaction: { mode: 'nearest', axis: 'x', intersect: false },
      plugins: { legend: { display: false }, tooltip: { enabled: true } },
      scales: { 
        x: { grid: { display: false } },
        y: { ticks: { callback: v => v + '%' } }
      },
      layout: { padding: { right: 50 } }
    }
  });
}

init();
</script>
</body>
</html>
